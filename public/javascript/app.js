// Generated by CoffeeScript 1.6.3
(function() {
  define(function(require) {
    var $, Backbone, Marionette, Tweets, TweetsView, app, io, tweets, tweetsView, viewOptions, _;
    $ = require('jquery');
    Backbone = require('backbone');
    _ = require('lodash');
    io = require('io');
    Marionette = require('marionette');
    Tweets = require('tweets');
    TweetsView = require('tweetsView');
    window.app = app = new Marionette.Application();
    tweets = new Tweets();
    viewOptions = {
      collection: tweets
    };
    tweetsView = new TweetsView(viewOptions);
    app.addRegions({
      main: '.tweets-container'
    });
    app.addInitializer(function() {
      return app.main.show(tweetsView);
    });
    return app.on('initialize:after', function() {
      var socket;
      socket = io.connect();
      socket.on("connect", function() {
        return console.log("Connected!");
      });
      socket.on("message", function(data) {
        return tweets.add(data);
      });
      return $("form").on("submit", function(e) {
        e.preventDefault();
        console.log("Changing track", $("form > input").val());
        socket.emit("change_track", {
          track: $("form > input").val()
        });
        socket.socket.disconnect();
        return socket.socket.reconnect();
      });
    });
  });

}).call(this);
